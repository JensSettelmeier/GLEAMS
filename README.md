![GLEAMS logo](images/logo_GLEAMS.png)

## GLEAMS

GLEAMS is a Learned Embedding for Annotating Mass Spectra. GLEAMS encodes mass spectra as vectors of features and feeds them to a neural network to embed them into a 32-dimensional space in which spectra generated by the same peptide are close together. It then detects "spectrum communities" of spectra generated by the same peptide.

This repository contains the gleams module code, a file containing trained network weights, and scripts for encoding and embedding spectra.o

### System Requirements and installation

This code has been tested on a Ubuntu 16.04 LTS 64-bit machine with an Intel i7 6700k, Nvidia RTX (2070 and 2080 Ti tested), 24 GB Ram. Any modern Linux distribution should be fine. We strongly recommend using Anaconda to set up the python dependencies.
After cloning the repo, you can create an conda environment with the environment.yml file in the repo root folder.

```
cd GLEAMS
conda create environment.yml
```

We run it with the following core dependencies:
  
Keras                              2.2.5              
Keras-Applications                 1.0.8              
Keras-Preprocessing                1.1.0              
numpy                              1.18.1                      
pandas                             0.25.3             
Pillow                             7.0.0      
scikit-image                       0.16.2             
scikit-learn                       0.22.1             
scikit-optimize                    0.5.2              
scipy                              1.4.1              
seaborn                            0.10.0              
tensorboard                        1.14.0             
tensorflow                         1.14.0             
tensorflow-estimator               1.14.0         

Further we use CUDA Version 10.0 and Driver Version 410.78, as well as cudnn version 7.4.1.
To be able to run it with a RTX Nvidia card you need to execute before at the beginning of your python session.

```
config_4RTX = tf.ConfigProto()
config_4RTX.gpu_options.allow_growth = True
```

If you also want to suppress the future warnings of tensorflow and Keras, add the following:

```
with warnings.catch_warnings():
    warnings.filterwarnings("ignore",category=FutureWarning)
    from tensorflow import keras
    from tensorflow.keras.preprocessing.text import Tokenizer
    from keras.backend.tensorflow_backend import set_session
    import tensorflow as tf
```
